<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SCL-90 æ·±åº¦å¿ƒç†æµ‹è¯„æŠ¥å‘Š</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- å¼•å…¥ Google Fonts å¢åŠ æ•°å­—ç¾æ„Ÿ -->
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;500;700&display=swap" rel="stylesheet">

    <style>
        body { 
            font-family: -apple-system, BlinkMacSystemFont, "PingFang SC", "Helvetica Neue", sans-serif; 
            background-color: #F2F4F6; 
        }
        .font-num { font-family: 'Outfit', sans-serif; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        .btn-active:active { transform: scale(0.98); opacity: 0.9; }
        
        /* æŠ¥å‘Šå¡ç‰‡çº¹ç†èƒŒæ™¯ */
        .report-bg {
            background-color: #ffffff;
            background-image: radial-gradient(#F1F5F9 1px, transparent 1px);
            background-size: 20px 20px;
        }
        
        /* ç»ç’ƒæ‹Ÿæ€å¯¼èˆª */
        .glass-nav {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }
    </style>
</head>
<body class="text-slate-800 antialiased min-h-screen flex flex-col items-center justify-center">

    <div id="app" class="w-full max-w-md mx-auto min-h-screen bg-white shadow-2xl relative overflow-hidden flex flex-col">
        
        <!-- 1. å°é¢é¡µ -->
        <div v-if="step === 'cover'" class="flex-1 flex flex-col items-center justify-center p-8 bg-gradient-to-b from-rose-50 to-white text-center">
            <div class="w-full max-w-[280px] mb-8 hover:scale-105 transition-transform duration-300 shadow-2xl shadow-rose-200 rounded-3xl overflow-hidden">
                <svg viewBox="0 0 800 800" xmlns="http://www.w3.org/2000/svg" class="w-full h-auto">
                  <defs>
                    <linearGradient id="grad1" x1="0%" y1="0%" x2="100%" y2="100%">
                      <stop offset="0%" style="stop-color:#FF9A9E;stop-opacity:1" />
                      <stop offset="100%" style="stop-color:#FECFEF;stop-opacity:1" />
                    </linearGradient>
                  </defs>
                  <rect width="800" height="800" fill="url(#grad1)" />
                  <circle cx="400" cy="400" r="300" fill="rgba(255,255,255,0.3)" />
                  <circle cx="400" cy="400" r="200" fill="rgba(255,255,255,0.6)" />
                  <text x="400" y="380" font-family="sans-serif" font-size="120" fill="#FF2442" text-anchor="middle" font-weight="900">90</text>
                  <text x="400" y="480" font-family="sans-serif" font-size="40" fill="#333" text-anchor="middle" font-weight="bold">SCL-90</text>
                  <text x="400" y="550" font-family="sans-serif" font-size="24" fill="#666" text-anchor="middle">ä¸“ä¸šå¿ƒç†å¥åº·æµ‹è¯„</text>
                </svg>
            </div>

            <h1 class="text-3xl font-extrabold text-slate-900 mb-2 tracking-tight">æ¢ç´¢å†…å¿ƒä¸–ç•Œ</h1>
            <p class="text-slate-500 mb-8 text-sm font-medium">åŸºäºå›½é™…å…¬è®¤ SCL-90 é‡è¡¨ Â· æ·±åº¦ç”»åƒ</p>
            
            <div class="bg-white border border-rose-100 p-5 rounded-2xl w-full mb-8 text-left shadow-sm relative overflow-hidden">
                <div class="absolute top-0 left-0 w-1 h-full bg-[#FF2442]"></div>
                <h3 class="font-bold text-slate-800 text-sm mb-2 flex items-center">
                    <span class="mr-2">ğŸ’¡</span> æµ‹è¯•éœ€çŸ¥
                </h3>
                <p class="text-xs text-slate-500 leading-relaxed">
                    è¯·æ ¹æ®æ‚¨<b>æœ€è¿‘ä¸€å‘¨</b>çš„å®é™…æ„Ÿå—å›ç­”ã€‚<br>æ— å¯¹é”™ä¹‹åˆ†ï¼Œè¯·ç›´è§‰ä½œç­”ï¼Œä»¥è·å–æœ€å‡†ç¡®ç»“æœã€‚
                </p>
            </div>

            <button @click="startTest" class="btn-active w-full bg-[#FF2442] text-white py-4 rounded-2xl font-bold text-lg shadow-lg shadow-rose-200 flex items-center justify-center gap-2">
                <span>å¼€å§‹æµ‹è¯„</span>
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z" clip-rule="evenodd" /></svg>
            </button>
        </div>

        <!-- 2. ç­”é¢˜é¡µ -->
        <div v-else-if="step === 'test'" class="flex-1 flex flex-col bg-slate-50">
            <div class="h-1.5 bg-slate-200 w-full">
                <div class="h-full bg-[#FF2442] transition-all duration-300 ease-out" :style="{ width: progress + '%' }"></div>
            </div>
            
            <div class="p-6 flex-1 overflow-y-auto no-scrollbar flex flex-col justify-center max-w-md mx-auto w-full">
                <div class="mb-8">
                    <span class="inline-block bg-rose-100 text-[#FF2442] px-3 py-1 rounded-full text-xs font-bold mb-4 font-num">
                        Question {{ currentQuestionIndex + 1 }} / {{ questions.length }}
                    </span>
                    <h2 class="text-2xl font-bold text-slate-800 leading-snug">
                        {{ questions[currentQuestionIndex].text }}
                    </h2>
                </div>

                <div class="space-y-3">
                    <button v-for="(option, val) in options" :key="val" 
                        @click="selectOption(val)"
                        class="btn-active w-full text-left p-5 bg-white border border-slate-200 rounded-2xl shadow-sm hover:border-[#FF2442] hover:shadow-md transition-all flex justify-between items-center group">
                        <span class="font-medium text-slate-600 group-hover:text-[#FF2442]">{{ option }}</span>
                        <div class="w-5 h-5 rounded-full border-2 border-slate-200 group-hover:border-[#FF2442] flex items-center justify-center">
                            <div class="w-2.5 h-2.5 bg-[#FF2442] rounded-full opacity-0 group-hover:opacity-100 transition-opacity"></div>
                        </div>
                    </button>
                </div>
            </div>
        </div>

        <!-- 3. ç»“æœåˆ†æé¡µ (é‡æ„ç‰ˆ) -->
        <div v-else-if="step === 'result'" class="flex-1 flex flex-col bg-[#F2F4F6] overflow-y-auto no-scrollbar relative">
            <!-- é¡¶éƒ¨æ‚¬æµ®å¯¼èˆª -->
            <div class="glass-nav px-4 py-3 shadow-sm flex justify-between items-center sticky top-0 z-20 border-b border-white/50">
                <span class="font-bold text-slate-800 text-sm">ğŸ“‹ æµ‹è¯„æ¡£æ¡ˆ</span>
                <button @click="downloadReport" class="bg-slate-900 text-white text-xs px-4 py-2 rounded-full font-medium hover:bg-slate-700 transition-colors flex items-center gap-1">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z" clip-rule="evenodd" /></svg>
                    ä¿å­˜æŠ¥å‘Š
                </button>
            </div>

            <!-- æŠ¥å‘Šæˆªå›¾åŒºåŸŸ -->
            <div class="p-4 pb-24" id="report-capture">
                <div class="report-bg rounded-3xl shadow-xl border border-slate-100 overflow-hidden">
                    
                    <!-- æŠ¥å‘Šå¤´éƒ¨ -->
                    <div class="bg-slate-900 text-white p-6 pb-12 relative overflow-hidden">
                        <div class="absolute top-[-50%] right-[-20%] w-64 h-64 bg-[#FF2442] rounded-full opacity-20 blur-3xl"></div>
                        <div class="absolute bottom-[-20%] left-[-10%] w-40 h-40 bg-blue-500 rounded-full opacity-20 blur-3xl"></div>
                        
                        <div class="flex justify-between items-start relative z-10">
                            <div>
                                <h1 class="text-2xl font-bold mb-1">å¿ƒç†å¥åº·ç”»åƒ</h1>
                                <p class="text-slate-400 text-xs font-num tracking-wider uppercase">SCL-90 / REF: {{ Math.floor(Math.random()*100000) }}</p>
                            </div>
                            <div class="text-right">
                                <p class="text-3xl font-bold font-num">{{ totalScore }}</p>
                                <p class="text-[10px] text-slate-400 uppercase">Total Score</p>
                            </div>
                        </div>
                    </div>

                    <!-- æ ¸å¿ƒç»“è®ºå¡ç‰‡ (ä¸Šç§»å åŠ ) -->
                    <div class="mx-4 -mt-8 relative z-10 bg-white p-5 rounded-2xl shadow-lg border-l-4" :class="overallStatus.borderColor">
                        <div class="flex justify-between items-center mb-2">
                            <span class="text-xs text-slate-400 uppercase font-bold tracking-wide">ç»¼åˆçŠ¶æ€è¯„ä¼°</span>
                            <span class="px-2 py-1 rounded text-xs font-bold" :class="overallStatus.badgeClass">
                                {{ overallStatus.label }}
                            </span>
                        </div>
                        <p class="text-sm text-slate-600 leading-relaxed">
                            {{ overallStatus.desc }}
                        </p>
                    </div>

                    <!-- é›·è¾¾å›¾å¯è§†åŒ– -->
                    <div class="p-6">
                        <h4 class="font-bold text-slate-800 text-sm mb-4 flex items-center">
                            <span class="w-1 h-4 bg-[#FF2442] rounded-full mr-2"></span>
                            ç—‡çŠ¶åˆ†å¸ƒé›·è¾¾
                        </h4>
                        <div class="w-full aspect-square max-h-64 relative">
                            <canvas id="radarChart"></canvas>
                        </div>
                    </div>

                    <!-- å…³é”®æŒ‡æ ‡æ•°æ®ç½‘æ ¼ -->
                    <div class="grid grid-cols-3 gap-3 px-4 mb-6">
                        <div class="bg-slate-50 p-3 rounded-xl text-center border border-slate-100">
                            <p class="text-xs text-slate-400 mb-1">å¹³å‡åˆ†</p>
                            <p class="text-xl font-bold text-slate-800 font-num">{{ avgScore }}</p>
                        </div>
                        <div class="bg-slate-50 p-3 rounded-xl text-center border border-slate-100">
                            <p class="text-xs text-slate-400 mb-1">é˜³æ€§é¡¹ç›®</p>
                            <p class="text-xl font-bold text-[#FF2442] font-num">{{ positiveItems }}</p>
                            <p class="text-[10px] text-slate-400">/ 90</p>
                        </div>
                        <div class="bg-slate-50 p-3 rounded-xl text-center border border-slate-100">
                            <p class="text-xs text-slate-400 mb-1">é˜´æ€§é¡¹ç›®</p>
                            <p class="text-xl font-bold text-green-600 font-num">{{ 90 - positiveItems }}</p>
                        </div>
                    </div>

                    <!-- è¯¦ç»†å› å­åˆ†æ -->
                    <div class="px-4 mb-6">
                        <h4 class="font-bold text-slate-800 text-sm mb-4 flex items-center">
                            <span class="w-1 h-4 bg-blue-500 rounded-full mr-2"></span>
                            æ·±åº¦å› å­è§£ç 
                        </h4>
                        
                        <div class="space-y-3">
                            <div v-for="factor in factors" :key="factor.name" class="flex items-center bg-white p-3 rounded-xl border border-slate-100 shadow-sm">
                                <!-- å› å­å -->
                                <div class="w-20 flex-shrink-0">
                                    <p class="text-sm font-bold text-slate-700">{{ factor.name }}</p>
                                </div>
                                
                                <!-- è¿›åº¦æ¡ -->
                                <div class="flex-1 mx-3">
                                    <div class="h-2 w-full bg-slate-100 rounded-full overflow-hidden">
                                        <div class="h-full rounded-full transition-all duration-1000"
                                             :class="getScoreColorClass(factor.score)"
                                             :style="{ width: (factor.score / 5 * 100) + '%' }"></div>
                                    </div>
                                </div>

                                <!-- åˆ†æ•°ä¸çŠ¶æ€ -->
                                <div class="w-20 text-right">
                                    <span class="block text-sm font-bold font-num" :class="getTextColorClass(factor.score)">
                                        {{ factor.score.toFixed(2) }}
                                    </span>
                                    <span class="text-[10px] px-1.5 py-0.5 rounded bg-slate-100 text-slate-500">
                                        {{ getLevel(factor.score) }}
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- æ™ºèƒ½å»ºè®®/å¿ƒç†å¤„æ–¹ -->
                    <div class="bg-slate-50 mx-4 mb-6 p-4 rounded-2xl border border-dashed border-slate-300">
                        <h4 class="font-bold text-slate-800 text-sm mb-3">ğŸ’¡ ä¸“å±è°ƒèŠ‚å»ºè®®</h4>
                        <div v-if="topRiskFactor" class="text-xs text-slate-600 space-y-2">
                            <p>æ‚¨çš„ä¸»è¦å›°æ‰°å¯èƒ½æ¥è‡ª <b>{{ topRiskFactor.name }}</b>ã€‚</p>
                            <p class="bg-white p-2 rounded border border-slate-100 shadow-sm">
                                {{ getAdvice(topRiskFactor.name) }}
                            </p>
                        </div>
                        <div v-else class="text-xs text-green-600 bg-green-50 p-2 rounded">
                            æ‚¨çš„å¿ƒç†çŠ¶æ€éå¸¸å¥åº·ï¼è¯·ç»§ç»­ä¿æŒä¹è§‚çš„ç”Ÿæ´»æ€åº¦ï¼Œé€‚åº¦è¿åŠ¨ï¼Œäº«å—ç”Ÿæ´»ã€‚
                        </div>
                    </div>

                    <!-- åº•éƒ¨æ°´å° -->
                    <div class="text-center py-6 bg-slate-900">
                         <svg width="150" height="40" viewBox="0 0 150 40" xmlns="http://www.w3.org/2000/svg" class="mx-auto opacity-70">
                           <text x="75" y="25" font-family="sans-serif" font-size="14" fill="#FFFFFF" text-anchor="middle" letter-spacing="1">SCL-90 Â· å¿ƒç†æ¡£æ¡ˆ</text>
                        </svg>
                        <p class="text-[10px] text-slate-500 mt-1">ç»“æœä»…ä¾›å‚è€ƒï¼Œä¸ä½œä¸ºåŒ»å­¦è¯Šæ–­ä¾æ®</p>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <script>
        const { createApp } = Vue;

        createApp({
            data() {
                return {
                    step: 'cover',
                    currentQuestionIndex: 0,
                    answers: [],
                    options: {
                        1: "ä»æ—  (æ²¡æœ‰æ„Ÿè§‰)",
                        2: "è½»åº¦ (å¶æœ‰ï¼Œä¸å½±å“)",
                        3: "ä¸­åº¦ (æœ‰çš„ï¼Œæœ‰ä¸€å®šå½±å“)",
                        4: "åé‡ (å¸¸æœ‰ï¼Œå½±å“è¾ƒå¤§)",
                        5: "ä¸¥é‡ (ååˆ†ä¸¥é‡)"
                    },
                    // 90é“å®Œæ•´é¢˜ç›®
                    questions: [
                        {id:1, text:"å¤´ç—›"}, {id:2, text:"ç¥ç»è¿‡æ•ï¼Œå¿ƒä¸­ä¸è¸å®"}, {id:3, text:"å¤´è„‘ä¸­æœ‰ä¸å¿…è¦çš„æƒ³æ³•æˆ–å­—å¥ç›˜æ—‹"}, {id:4, text:"å¤´æ™•æˆ–æ˜å€’"}, {id:5, text:"å¯¹å¼‚æ€§çš„å…´è¶£å‡é€€"},
                        {id:6, text:"å¯¹æ—äººè´£å¤‡æ±‚å…¨"}, {id:7, text:"æ„Ÿåˆ°åˆ«äººèƒ½æ§åˆ¶æ‚¨çš„æ€æƒ³"}, {id:8, text:"è´£æ€ªåˆ«äººåˆ¶é€ éº»çƒ¦"}, {id:9, text:"å¿˜æ€§å¤§"}, {id:10, text:"æ‹…å¿ƒè‡ªå·±çš„è¡£é¥°æ•´é½åŠä»ªæ€çš„ç«¯æ­£"},
                        {id:11, text:"å®¹æ˜“çƒ¦æ¼å’Œæ¿€åŠ¨"}, {id:12, text:"èƒ¸ç—›"}, {id:13, text:"å®³æ€•ç©ºæ—·çš„åœºæ‰€æˆ–è¡—é“"}, {id:14, text:"æ„Ÿåˆ°è‡ªå·±çš„ç²¾åŠ›ä¸‹é™ï¼Œæ´»åŠ¨å‡æ…¢"}, {id:15, text:"æƒ³ç»“æŸè‡ªå·±çš„ç”Ÿå‘½"},
                        {id:16, text:"å¬åˆ°æ—äººå¬ä¸åˆ°çš„å£°éŸ³"}, {id:17, text:"å‘æŠ–"}, {id:18, text:"æ„Ÿåˆ°ç»å¤§å¤šæ•°äººä¸å¯ä¿¡"}, {id:19, text:"èƒƒå£ä¸å¥½"}, {id:20, text:"å®¹æ˜“å“­æ³£"},
                        {id:21, text:"åŒå¼‚æ€§ç›¸å¤„æ—¶æ„Ÿåˆ°å®³ç¾ä¸è‡ªåœ¨"}, {id:22, text:"æ„Ÿåˆ°å—éª—ï¼Œä¸­äº†åœˆå¥—æˆ–æœ‰äººæƒ³æŠ“ä½æ‚¨"}, {id:23, text:"æ— ç¼˜æ— æ•…åœ°çªç„¶æ„Ÿåˆ°å®³æ€•"}, {id:24, text:"è‡ªå·±ä¸èƒ½æ§åˆ¶åœ°å‘è„¾æ°”"}, {id:25, text:"æ€•å•ç‹¬å‡ºé—¨"},
                        {id:26, text:"ç»å¸¸è´£æ€ªè‡ªå·±"}, {id:27, text:"è…°ç—›"}, {id:28, text:"æ„Ÿåˆ°éš¾ä»¥å®Œæˆä»»åŠ¡"}, {id:29, text:"æ„Ÿåˆ°å­¤ç‹¬"}, {id:30, text:"æ„Ÿåˆ°è‹¦é—·"},
                        {id:31, text:"è¿‡åˆ†æ‹…å¿§"}, {id:32, text:"å¯¹äº‹ç‰©ä¸æ„Ÿå…´è¶£"}, {id:33, text:"æ„Ÿåˆ°å®³æ€•"}, {id:34, text:"æ‚¨çš„æƒ…æ„Ÿå®¹æ˜“å—åˆ°ä¼¤å®³"}, {id:35, text:"æ—äººèƒ½çŸ¥é“æ‚¨çš„ç§ä¸‹æƒ³æ³•"},
                        {id:36, text:"æ„Ÿåˆ°åˆ«äººä¸ç†è§£æ‚¨ã€ä¸åŒæƒ…æ‚¨"}, {id:37, text:"æ„Ÿåˆ°äººä»¬å¯¹æ‚¨ä¸å‹å¥½ï¼Œä¸å–œæ¬¢æ‚¨"}, {id:38, text:"åšäº‹å¿…é¡»åšå¾—å¾ˆæ…¢ä»¥ä¿è¯åšå¾—æ­£ç¡®"}, {id:39, text:"å¿ƒè·³å¾—å¾ˆå‰å®³"}, {id:40, text:"æ¶å¿ƒæˆ–èƒƒéƒ¨ä¸èˆ’æœ"},
                        {id:41, text:"æ„Ÿåˆ°æ¯”ä¸ä¸Šåˆ«äºº"}, {id:42, text:"è‚Œè‚‰é…¸ç—›"}, {id:43, text:"æ„Ÿåˆ°æœ‰äººåœ¨çœ‹ç€æ‚¨ã€è°ˆè®ºæ‚¨"}, {id:44, text:"éš¾ä»¥å…¥ç¡"}, {id:45, text:"åšäº‹å¿…é¡»åå¤æ£€æŸ¥"},
                        {id:46, text:"éš¾ä»¥ä½œå‡ºå†³å®š"}, {id:47, text:"æ€•ä¹˜ç”µè½¦ã€å…¬å…±æ±½è½¦ã€åœ°é“æˆ–ç«è½¦"}, {id:48, text:"å‘¼å¸æœ‰å›°éš¾"}, {id:49, text:"ä¸€é˜µé˜µå‘å†·æˆ–å‘çƒ­"}, {id:50, text:"å› ä¸ºæ„Ÿåˆ°å®³æ€•è€Œé¿å¼€æŸäº›ä¸œè¥¿ã€åœºåˆæˆ–æ´»åŠ¨"},
                        {id:51, text:"è„‘å­å˜ç©ºäº†"}, {id:52, text:"èº«ä½“å‘éº»æˆ–åˆºç—›"}, {id:53, text:"å–‰å’™æœ‰æ¢—å¡æ„Ÿ"}, {id:54, text:"æ„Ÿåˆ°æ²¡æœ‰å‰é€”ï¼Œæ²¡æœ‰å¸Œæœ›"}, {id:55, text:"ä¸èƒ½é›†ä¸­æ³¨æ„åŠ›"},
                        {id:56, text:"æ„Ÿåˆ°èº«ä½“çš„æŸä¸€éƒ¨åˆ†è½¯å¼±æ— åŠ›"}, {id:57, text:"æ„Ÿåˆ°ç´§å¼ æˆ–å®¹æ˜“ç´§å¼ "}, {id:58, text:"æ„Ÿåˆ°æ‰‹æˆ–è„šå‘é‡"}, {id:59, text:"æƒ³åˆ°æ­»äº¡çš„äº‹"}, {id:60, text:"åƒå¾—å¤ªå¤š"},
                        {id:61, text:"å½“åˆ«äººçœ‹ç€æ‚¨æˆ–è°ˆè®ºæ‚¨æ—¶æ„Ÿåˆ°ä¸è‡ªåœ¨"}, {id:62, text:"æœ‰ä¸€äº›ä¸å±äºæ‚¨è‡ªå·±çš„æƒ³æ³•"}, {id:63, text:"æœ‰æƒ³æ‰“äººæˆ–ä¼¤å®³ä»–äººçš„å†²åŠ¨"}, {id:64, text:"é†’å¾—å¤ªæ—©"}, {id:65, text:"å¿…é¡»åå¤æ´—æ‰‹ã€ç‚¹æ•°ç›®æˆ–è§¦æ‘¸æŸäº›ä¸œè¥¿"},
                        {id:66, text:"ç¡å¾—ä¸ç¨³ä¸æ·±"}, {id:67, text:"æœ‰æƒ³æ‘”åæˆ–ç ´åä¸œè¥¿çš„å†²åŠ¨"}, {id:68, text:"æœ‰äº›äººä¸æ‚¨ä¸ºæ•Œ"}, {id:69, text:"åœ¨å•†åº—æˆ–ç”µå½±é™¢ç­‰äººå¤šçš„åœ°æ–¹æ„Ÿåˆ°ä¸è‡ªåœ¨"}, {id:70, text:"æ„Ÿåˆ°ä»»ä½•äº‹æƒ…éƒ½å¾ˆå›°éš¾"},
                        {id:71, text:"æ„Ÿåˆ°å¿ƒç¥ä¸å®"}, {id:72, text:"æ„Ÿåˆ°è‡ªå·±çš„å¤´ç—›"}, {id:73, text:"ä¸åˆç¾¤"}, {id:74, text:"ç»å¸¸äº‰è®º"}, {id:75, text:"å•ç‹¬ä¸€äººæ—¶ç¥ç»å¾ˆç´§å¼ "},
                        {id:76, text:"åˆ«äººå¯¹æ‚¨çš„æˆç»©æ²¡æœ‰ä½œå‡ºæ°å½“çš„è¯„ä»·"}, {id:77, text:"å³ä½¿å’Œåˆ«äººåœ¨ä¸€èµ·ä¹Ÿæ„Ÿåˆ°å­¤å•"}, {id:78, text:"æ„Ÿåˆ°åç«‹ä¸å®‰"}, {id:79, text:"æ„Ÿåˆ°è‡ªå·±ä¸€æ— æ˜¯å¤„"}, {id:80, text:"æ„Ÿåˆ°ç†Ÿæ‚‰çš„ä¸œè¥¿å˜æˆé™Œç”Ÿæˆ–ä¸åƒæ˜¯çœŸçš„"},
                        {id:81, text:"å¤§å«æˆ–æ‘”ä¸œè¥¿"}, {id:82, text:"å®³æ€•åœ¨å…¬å…±åœºåˆä¼šæ™•å€’"}, {id:83, text:"æ„Ÿåˆ°åˆ«äººæƒ³åˆ©ç”¨æ‚¨"}, {id:84, text:"ä¸ºä¸€äº›æœ‰å…³æ€§çš„æƒ³æ³•è€Œå¾ˆè‹¦æ¼"}, {id:85, text:"æ‚¨è®¤ä¸ºåº”è¯¥å› ä¸ºè‡ªå·±çš„è¿‡é”™è€Œå—åˆ°æƒ©ç½š"},
                        {id:86, text:"æ„Ÿåˆ°è¦èµ¶å¿«æŠŠäº‹æƒ…åšå®Œ"}, {id:87, text:"æ„Ÿåˆ°è‡ªå·±çš„èº«ä½“æœ‰ä¸¥é‡é—®é¢˜"}, {id:88, text:"ä»æœªæ„Ÿåˆ°å’Œå…¶ä»–äººå¾ˆäº²è¿‘"}, {id:89, text:"æ„Ÿåˆ°æœ‰ç½ªæ¶æ„Ÿ"}, {id:90, text:"æ„Ÿåˆ°è‡ªå·±çš„è„‘å­æœ‰æ¯›ç—…"}
                    ],
                    factors: []
                }
            },
            computed: {
                progress() { return ((this.currentQuestionIndex) / this.questions.length) * 100; },
                totalScore() { return this.answers.reduce((a, b) => a + b, 0); },
                avgScore() { return this.answers.length ? (this.totalScore / this.answers.length).toFixed(2) : 0; },
                positiveItems() { return this.answers.filter(s => s >= 2).length; },
                
                // è®¡ç®—æœ€é«˜åˆ†å› å­ï¼ˆç”¨äºå»ºè®®ï¼‰
                topRiskFactor() {
                    if (this.factors.length === 0) return null;
                    // è¿‡æ»¤å‡ºåˆ†æ•°å¤§äº2çš„å› å­ï¼Œå¹¶æ’åº
                    const risks = this.factors.filter(f => f.score >= 2).sort((a, b) => b.score - a.score);
                    return risks.length > 0 ? risks[0] : null;
                },

                // ç»¼åˆçŠ¶æ€è¯„ä¼°é€»è¾‘
                overallStatus() {
                    const avg = parseFloat(this.avgScore);
                    const pos = this.positiveItems;
                    
                    if (avg < 1.5 && pos < 10) {
                        return { 
                            label: 'å¿ƒç†é˜³å…‰ â˜€ï¸', 
                            desc: 'æ‚¨çš„å¿ƒç†çŠ¶æ€éå¸¸å¥åº·ï¼Œé€‚åº”èƒ½åŠ›å¼ºï¼Œå¿ƒæ€ç§¯æã€‚è¯·ç»§ç»­ä¿æŒè¿™ç§è‰¯å¥½çš„ç”Ÿæ´»èŠ‚å¥ï¼',
                            borderColor: 'border-green-500',
                            badgeClass: 'bg-green-100 text-green-600'
                        };
                    } else if (avg < 2) {
                        return { 
                            label: 'çŠ¶æ€è‰¯å¥½ ğŸŒ¿', 
                            desc: 'æ•´ä½“çŠ¶æ€ä¸é”™ï¼Œå¯èƒ½å¶æœ‰å°æƒ…ç»ªï¼Œä½†å±äºæ­£å¸¸çš„ç”Ÿæ´»æ³¢åŠ¨ã€‚æ³¨æ„åŠ³é€¸ç»“åˆå³å¯ã€‚',
                            borderColor: 'border-emerald-400',
                            badgeClass: 'bg-emerald-100 text-emerald-600'
                        };
                    } else if (avg < 3) {
                        return { 
                            label: 'è½»åº¦é¢„è­¦ âš ï¸', 
                            desc: 'æ‚¨è¿‘æœŸå¯èƒ½æ‰¿å—äº†ä¸€äº›å‹åŠ›ï¼Œå‡ºç°äº†ä¸€å®šçš„å¿ƒç†æ³¢åŠ¨ã€‚å»ºè®®é€‚å½“æ”¾æ¾ï¼Œå¤šè¿›è¡Œæˆ·å¤–æ´»åŠ¨æˆ–ä¸æœ‹å‹å€¾è¯‰ã€‚',
                            borderColor: 'border-yellow-400',
                            badgeClass: 'bg-yellow-100 text-yellow-700'
                        };
                    } else {
                        return { 
                            label: 'éœ€è¦å…³æ³¨ ğŸ†˜', 
                            desc: 'æ‚¨çš„å¿ƒç†è´Ÿæ‹…è¾ƒé‡ï¼Œå¤šä¸ªæ–¹é¢å­˜åœ¨æ˜æ˜¾å›°æ‰°ã€‚å¼ºçƒˆå»ºè®®å¯»æ±‚ä¸“ä¸šçš„å¿ƒç†å’¨è¯¢å¸ˆå¸®åŠ©ï¼Œä¸è¦ç‹¬è‡ªæ‰¿æ‹…ã€‚',
                            borderColor: 'border-red-500',
                            badgeClass: 'bg-red-100 text-red-600'
                        };
                    }
                }
            },
            methods: {
                startTest() { this.step = 'test'; },
                selectOption(val) {
                    this.answers.push(parseInt(val));
                    if (this.currentQuestionIndex < this.questions.length - 1) {
                        this.currentQuestionIndex++;
                    } else {
                        this.calculateResult();
                    }
                },
                getScoreColorClass(score) {
                    if (score < 2) return 'bg-green-400';
                    if (score < 3) return 'bg-yellow-400';
                    return 'bg-red-500';
                },
                getTextColorClass(score) {
                    if (score < 2) return 'text-green-600';
                    if (score < 3) return 'text-yellow-600';
                    return 'text-red-600';
                },
                getLevel(score) {
                    if(score < 2) return "æ­£å¸¸";
                    if(score < 3) return "è½»åº¦";
                    if(score < 4) return "ä¸­åº¦";
                    return "ä¸¥é‡";
                },
                getAdvice(factorName) {
                    const adviceMap = {
                        'èº¯ä½“åŒ–': 'æ‚¨å¯èƒ½å°†å¿ƒç†å‹åŠ›è½¬åŒ–ä¸ºäº†èº«ä½“ä¸é€‚ï¼ˆå¦‚å¤´ç—›ã€èƒƒç—›ï¼‰ã€‚å»ºè®®è¿›è¡Œæ¸è¿›å¼è‚Œè‚‰æ”¾æ¾è®­ç»ƒï¼Œå¹¶æ’é™¤å™¨è´¨æ€§ç—…å˜ã€‚',
                        'å¼ºè¿«ç—‡çŠ¶': 'å°è¯•æ¥çº³é‚£äº›åå¤å‡ºç°çš„å¿µå¤´ï¼Œä¸è¦åˆ»æ„å‹åˆ¶ã€‚è®¾å®šä¸“é—¨çš„â€œæ‹…å¿§æ—¶é—´â€ï¼Œå…¶ä½™æ—¶é—´ä¸“æ³¨äºå½“ä¸‹çš„è¡ŒåŠ¨ã€‚',
                        'äººé™…æ•æ„Ÿ': 'å»ºç«‹è‡ªä¿¡æ˜¯å…³é”®ã€‚ä¸è¦è¿‡åº¦è§£è¯»ä»–äººçš„çœ¼ç¥æˆ–è¨€è¯­ï¼Œå°è¯•åœ¨å°ç¾¤ä½“ä¸­ä¸»åŠ¨è¡¨è¾¾ä¸€æ¬¡è‡ªå·±çš„è§‚ç‚¹ã€‚',
                        'æŠ‘éƒ': 'æ¥çº³è‡ªå·±çš„ä½è½æƒ…ç»ªï¼Œä½†ä¸è¦æ²‰æµ¸å…¶ä¸­ã€‚åšæŒè¿åŠ¨ï¼ˆå¦‚æ…¢è·‘ï¼‰ï¼Œä¿æŒè§„å¾‹ä½œæ¯ï¼Œå¯»æ‰¾ä¿¡ä»»çš„äººå€¾è¯‰ã€‚',
                        'ç„¦è™‘': 'ä¸“æ³¨äºå‘¼å¸ã€‚å½“æ„Ÿåˆ°æƒŠææ—¶ï¼Œå°è¯•4-7-8å‘¼å¸æ³•ã€‚å‡å°‘å’–å•¡å› æ‘„å…¥ï¼Œå…³æ³¨å½“ä¸‹èƒ½æ§åˆ¶çš„äº‹æƒ…ã€‚',
                        'æ•Œå¯¹': 'å½“æ„¤æ€’æ¥è¢­æ—¶ï¼Œå…ˆç¦»å¼€ç°åœºå†·é™3åˆ†é’Ÿã€‚å°è¯•ç”¨â€œæˆ‘æ„Ÿåˆ°...â€ä»£æ›¿â€œä½ æ€»æ˜¯...â€æ¥è¡¨è¾¾ä¸æ»¡ã€‚',
                        'ææ€–': 'é‡‡ç”¨ç³»ç»Ÿè„±æ•æ³•ï¼Œä»è½»å¾®ææƒ§çš„åœºæ™¯å¼€å§‹é€æ­¥å°è¯•æ¥è§¦ã€‚ç›¸ä¿¡ææƒ§æ„Ÿæ˜¯ä¼šéšç€æ—¶é—´æ¶ˆé€€çš„ã€‚',
                        'åæ‰§': 'å°è¯•æ¢ä½æ€è€ƒï¼Œé—®è‡ªå·±â€œæ˜¯å¦æœ‰å…¶ä»–è§£é‡Šçš„å¯èƒ½æ€§ï¼Ÿâ€ã€‚å»ºç«‹å¯¹ä»–äººçš„åŸºæœ¬ä¿¡ä»»ï¼Œå‡å°‘æ— ç«¯çš„çŒœç–‘ã€‚',
                        'ç²¾ç¥ç—…æ€§': 'å¦‚æœæ„Ÿè§‰æ€ç»ªæ··ä¹±æˆ–æ„ŸçŸ¥å¼‚å¸¸ï¼Œè¯·åŠ¡å¿…ä¿è¯å……è¶³ç¡çœ ï¼Œé¿å…ç‹¬å¤„ï¼Œå¹¶å¯»æ±‚ä¸“ä¸šåŒ»ç”Ÿçš„å¸®åŠ©ã€‚'
                    };
                    return adviceMap[factorName] || 'å»ºè®®ä¿æŒè§„å¾‹ä½œæ¯ï¼Œå¤šè¿›è¡Œæœ‰æ°§è¿åŠ¨ã€‚';
                },
                calculateResult() {
                    const getScore = (id) => this.answers[id - 1] || 1;
                    const calcFactor = (ids) => ids.reduce((acc, id) => acc + getScore(id), 0) / ids.length;

                    const factorDefinitions = [
                        { name: 'èº¯ä½“åŒ–', ids: [1,4,12,27,40,42,48,49,53,56,58,86] },
                        { name: 'å¼ºè¿«ç—‡çŠ¶', ids: [3,9,10,28,38,45,46,51,55,65] },
                        { name: 'äººé™…æ•æ„Ÿ', ids: [6,21,34,36,37,41,61,69,73] },
                        { name: 'æŠ‘éƒ', ids: [5,14,15,20,22,26,29,30,31,32,54,71,79] },
                        { name: 'ç„¦è™‘', ids: [2,17,23,33,39,57,72,78,80,81] },
                        { name: 'æ•Œå¯¹', ids: [11,24,63,67,74,81] },
                        { name: 'ææ€–', ids: [13,25,47,50,70,75,82] },
                        { name: 'åæ‰§', ids: [8,18,43,68,76,83] },
                        { name: 'ç²¾ç¥ç—…æ€§', ids: [7,16,35,62,77,84,85,87,88,90] }
                    ];

                    this.factors = factorDefinitions.map(f => ({ name: f.name, score: calcFactor(f.ids) }));
                    this.step = 'result';
                    this.$nextTick(() => this.renderChart());
                },
                renderChart() {
                    const ctx = document.getElementById('radarChart').getContext('2d');
                    // åˆ›å»ºæ¸å˜è‰²
                    const gradient = ctx.createRadialGradient(150, 150, 0, 150, 150, 150);
                    gradient.addColorStop(0, 'rgba(255, 36, 66, 0.1)');
                    gradient.addColorStop(1, 'rgba(255, 36, 66, 0.4)');

                    new Chart(ctx, {
                        type: 'radar',
                        data: {
                            labels: this.factors.map(f => f.name),
                            datasets: [{
                                label: 'å› å­åˆ†',
                                data: this.factors.map(f => f.score),
                                backgroundColor: gradient,
                                borderColor: '#FF2442',
                                borderWidth: 2,
                                pointBackgroundColor: '#fff',
                                pointBorderColor: '#FF2442',
                                pointRadius: 3
                            }]
                        },
                        options: {
                            maintainAspectRatio: false,
                            scales: {
                                r: {
                                    angleLines: { color: '#eee' },
                                    grid: { color: '#f0f0f0' },
                                    pointLabels: { 
                                        font: { size: 11, family: "'PingFang SC', sans-serif" },
                                        color: '#64748b'
                                    },
                                    suggestedMin: 0,
                                    suggestedMax: 4,
                                    ticks: { display: false } // éšè—åˆ»åº¦æ•°å­—ï¼Œæ›´ç®€æ´
                                }
                            },
                            plugins: { legend: { display: false } }
                        }
                    });
                },
                downloadReport() {
                    const element = document.getElementById("report-capture");
                    // ä¸´æ—¶éšè—æ»šåŠ¨æ¡ä»¥è·å¾—æ›´å¥½æˆªå›¾
                    element.style.overflow = 'visible'; 
                    
                    html2canvas(element, {
                        scale: 2,
                        useCORS: true,
                        backgroundColor: "#F2F4F6",
                    }).then(canvas => {
                        const link = document.createElement('a');
                        link.download = 'æˆ‘çš„å¿ƒç†ç”»åƒ.png';
                        link.href = canvas.toDataURL("image/png");
                        link.click();
                        alert("âœ… æŠ¥å‘Šå·²ç”Ÿæˆï¼è¯·æŸ¥çœ‹ç›¸å†Œæˆ–ä¸‹è½½æ–‡ä»¶å¤¹ã€‚");
                    });
                }
            }
        }).mount('#app');
    </script>
</body>
</html>